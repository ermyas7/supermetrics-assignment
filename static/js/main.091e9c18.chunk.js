(this["webpackJsonpsupermetrics-assignment"]=this["webpackJsonpsupermetrics-assignment"]||[]).push([[0],{18:function(e,t,r){},19:function(e,t,r){},22:function(e,t,r){"use strict";r.r(t);var n=r(1),c=r.n(n),s=r(12),a=r.n(s),o=(r(18),r(19),r(3)),u=r.n(o),i=r(11),j=r(5),b=r(2),l=r(4),O=function(){var e=Object(j.a)(u.a.mark((function e(t,r){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,Object(l.a)({mode:"cors",headers:{"Content-Type":"application/json"}},r));case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(c=e.sent).error||!c.error.message){e.next=9;break}return e.abrupt("return",{error:c.error.message});case 9:return e.abrupt("return",{data:c.data});case 12:return e.prev=12,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",{error:e.t0.message});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,r){return e.apply(this,arguments)}}(),m=function(e,t){if(Array.isArray(e))return e.reduce((function(e,r){return e[r[t]]=e[r[t]]||[],e[r[t]].push(r),e}),Object.create(null))},h=function(e){var t=m(e,"from_id"),r={};return Object.keys(t).forEach((function(e){r[e]=function(e){var t=0;return Object.keys(e).forEach((function(r){t+=e[r].length})),t/Object.keys(e).length}(m(t[e],"month"))})),r},p=r(0),f=Object(n.createContext)(),d=function(e){var t=e.children,r=Object(n.useState)(""),c=Object(b.a)(r,2),s=c[0],a=c[1],o=Object(n.useState)(""),l=Object(b.a)(o,2),m=l[0],h=l[1],d=Object(n.useState)([]),g=Object(b.a)(d,2),x=g[0],v=g[1],k=Object(n.useState)(1),y=Object(b.a)(k,2),w=y[0],S=y[1],E=Object(n.useState)(!0),N=Object(b.a)(E,2),A=N[0],C=N[1];Object(n.useEffect)((function(){var e=window.localStorage.getItem("sl_token");a(e)}),[]);var M=Object(n.useCallback)(Object(j.a)(u.a.mark((function e(){var t,r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,O("".concat("https://api.supermetrics.com/assignment/posts","?sl_token=").concat(s,"&page=").concat(w),{method:"get"});case 3:t=e.sent,r=t.data,(n=t.error)?(h(n),C(!1)):(v((function(e){return[].concat(Object(i.a)(e),Object(i.a)(r.posts))})),S(r.page+1),10===r.page&&C(!1));case 7:case"end":return e.stop()}}),e)}))),[w,s]);return Object(n.useEffect)((function(){s&&w<=10&&M()}),[M,w,s]),Object(p.jsx)(f.Provider,{value:{token:s,setToken:a,error:m,setError:h,posts:x,loading:A},children:t})},g=r(8),x=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(n.useState)(e),r=Object(b.a)(t,2),c=r[0],s=r[1],a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e.preventDefault(),t(),o()},o=function(){var e=Object.fromEntries(Object.entries(c).map((function(e){var t=Object(b.a)(e,2),r=t[0];return t[1],[r,""]})));s(e)};return{inputs:c,changeHandler:function(e){var t=e.target,r=t.value,n=t.name;s(Object(l.a)(Object(l.a)({},c),{},Object(g.a)({},n,r)))},submitHandler:a}}({name:"",email:""}),t=e.inputs,r=e.changeHandler,c=e.submitHandler,s=Object(n.useContext)(f),a=s.setToken,o=s.setError,i=Object(n.useCallback)(Object(j.a)(u.a.mark((function e(){var r,n,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",body:JSON.stringify({name:t.name,email:t.email,client_id:"ju16a6m81mhid5ue1z3v2g0uh"})},e.next=3,O("https://api.supermetrics.com/assignment/register",r);case 3:n=e.sent,c=n.data,(s=n.error)?o(s):(o(""),a(c.sl_token),window.localStorage.setItem("sl_token",c.sl_token));case 7:case"end":return e.stop()}}),e)}))),[t.email,t.name,o,a]);return Object(p.jsxs)("div",{className:"supermetrics-register",children:[Object(p.jsx)("h2",{className:"supermetrics-heading supermetrics-heading-secondary",children:"Register Token"}),Object(p.jsxs)("form",{className:"supermetrics-form",onSubmit:function(e){return c(e,i)},children:[Object(p.jsxs)("div",{className:"supermetrics-input-group",children:[Object(p.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(p.jsx)("input",{type:"email",id:"email",name:"email",onChange:r,value:t.email,required:!0})]}),Object(p.jsxs)("div",{className:"supermetrics-input-group",children:[Object(p.jsx)("label",{htmlFor:"name",children:"Name:"}),Object(p.jsx)("input",{type:"text",id:"name",name:"name",onChange:r,value:t.name,required:!0})]}),Object(p.jsx)("button",{type:"submit",children:"Register"})]})]})},v=function(){var e=Object(n.useContext)(f).error;return Object(p.jsxs)("h3",{children:[e," , Try to register token again! "]})},k=r(9),y=r.n(k),w=r(13),S=r.n(w),E=["January","February","March","April","May","June","July","August","September","October","November","December"];y.a.extend(S.a);var N=function(){var e=Object(n.useContext)(f).posts,t=Object(n.useMemo)((function(){return 0===e.length?[]:e.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{month:E[y()(e.created_time).month()],week:y()(e.created_time).isoWeek()})}))}),[e]),r=Object(n.useMemo)((function(){return Object.entries(function(e,t){var r=m(e,t),n={};return Object.keys(r).forEach((function(e){var t;n[e]=(t=r[e]).reduce((function(e,t){return e+t.message.length}),0)/t.length})),n}(t,"month"))}),[t]),c=Object(n.useMemo)((function(){return Object.entries(function(e,t){var r=m(e,t),n={};return Object.keys(r).forEach((function(e){n[e]=function(e){var t=e[0];return e.forEach((function(e){e.message.length>t.message.length&&(t=e)})),t}(r[e])})),n}(t,"month"))}),[t]),s=Object(n.useMemo)((function(){return Object.entries(function(e,t){var r=m(e,t),n={};return Object.keys(r).forEach((function(e){n[e]=r[e].length})),n}(t,"week"))}),[t]),a=Object(n.useMemo)((function(){return Object.entries(h(t))}),[t]);return console.log("------------------------------------------------"),console.log("Average character length of posts per month"),console.log(r),console.log("------------------------------------------------"),console.log("Longest post by character length per month"),console.log(c),console.log("------------------------------------------------"),console.log("Total posts split by week number"),console.log(s),console.log("------------------------------------------------"),console.log("Average number of posts per user per month"),console.log(a),0===e.length?null:Object(p.jsxs)("div",{className:"supermetrics-stats",children:[Object(p.jsx)("h2",{className:"supermetrics-heading",children:"Stats"}),Object(p.jsx)("br",{}),Object(p.jsx)("h3",{children:"Please check the log from the developer tool to see the detail data"}),Object(p.jsx)("hr",{}),Object(p.jsx)("br",{}),Object(p.jsx)("h3",{children:"Average character length of posts per month "}),Object(p.jsx)("br",{}),r.map((function(e){var t=Object(b.a)(e,2),r=t[0],n=t[1];return Object(p.jsx)("p",{children:"".concat(r," ------ ").concat(n)},r)})),Object(p.jsx)("br",{}),Object(p.jsx)("br",{}),Object(p.jsx)("hr",{}),Object(p.jsx)("br",{}),Object(p.jsx)("h3",{children:"Longest post by character length per month "}),Object(p.jsx)("br",{}),c.map((function(e){var t=Object(b.a)(e,2),r=t[0],c=t[1];return Object(p.jsxs)(n.Fragment,{children:[Object(p.jsx)("p",{children:"".concat(r," ------ ").concat(c.message)}),Object(p.jsx)("br",{})]},r)})),Object(p.jsx)("br",{}),Object(p.jsx)("br",{}),Object(p.jsx)("hr",{}),Object(p.jsx)("br",{}),Object(p.jsx)("h3",{children:"Total posts split by week number "}),Object(p.jsx)("br",{}),s.map((function(e){var t=Object(b.a)(e,2),r=t[0],n=t[1];return Object(p.jsx)("p",{children:"week no - ".concat(r," ------ number of posts - ").concat(n)},r)})),Object(p.jsx)("br",{}),Object(p.jsx)("br",{}),Object(p.jsx)("hr",{}),Object(p.jsx)("br",{}),Object(p.jsx)("h3",{children:"Average number of posts per user per month "}),Object(p.jsx)("br",{}),a.map((function(e){var t=Object(b.a)(e,2),r=t[0],n=t[1];return Object(p.jsx)("p",{children:"".concat(r," have ").concat(n," posts per month Avg")},r)})),Object(p.jsx)("br",{}),Object(p.jsx)("br",{}),Object(p.jsx)("hr",{}),Object(p.jsx)("br",{})]})};var A=function(){var e=Object(n.useContext)(f),t=e.token,r=e.error,c=e.loading,s=Object(n.useMemo)((function(){return!(t&&!r)}),[r,t]);return Object(p.jsxs)("div",{className:"supermetrics",children:[Object(p.jsx)("h1",{children:"Supermetrics API"}),c&&t&&Object(p.jsx)("p",{children:"Loading..."}),r&&Object(p.jsx)(v,{}),s&&Object(p.jsx)(x,{}),!s&&!c&&Object(p.jsx)(N,{})]})},C=function(){return Object(p.jsx)(d,{children:Object(p.jsx)(A,{})})};a.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(C,{})}),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.091e9c18.chunk.js.map